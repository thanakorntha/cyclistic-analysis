---
title: "Cyclistic Bike-Sharing Data Analysis"
author: "Thanakorn Thanakraikiti (Nun)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document: 
    toc: yes
    number_sections: yes
    fig_caption: true
    highlight: pygments
    latex_engine: pdflatex
fontfamily: iwona
fontsize: 10pt
papersize: a4
geometry: [top=1in, bottom=1in, right=1in, left=1in]
linestretch: 1.5
urlcolor: blue
header-includes:
  # Add logo on the top page
  - \usepackage{titling}
  - \pretitle{\begin{center}
    \includegraphics[width=3in,height=3in]{../logo.png}\LARGE\\}
  - \posttitle{\end{center}}
  # Make inline code gray
  - \definecolor{codegray}{HTML}{eeeeee}
  - \let\textttOrig\texttt
  - \renewcommand{\texttt}[1]{\textttOrig{\colorbox{codegray}{#1}}}
include-before:
  # Break TOC page to the next page
  - '`\newpage{}`{=latex}'
---

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = "/Users/thanakorn.tha/Code/data-analytics/cyclistic-analysis")
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  out.width = "100%",
  fig.align = "center", 
  fig.width = 6, 
  fig.height = 4
)
```

\let\oldsection\section
\renewcommand\section{\clearpage\oldsection}

# Intoduction

Cyclistic is a successful American bicycle-sharing program that was established in 2016. Since then, the program has grown to a fleet of 5,824 bicycles that are geotracked and locked into a network of 692 stations across Chicago. The bikes can be unlocked from one station and returned to any other station in the system at any time. Cyclistic users are more likely to ride for leisure, but approximately 30% use them to commute to work each day. 

Cyclistic's marketing strategy has primarily focused on building general awareness and appealing to broad consumer segments. The program offers a variety of pricing plans, including single-ride passes, full-day passes, and annual memberships. Cyclistic classifies its riders into the following groups based on these plans: *casual riders* (users who purchase single-ride passes or full-day passes) and *annual members* (users who purchase an annual membership).

Cyclistic's flexible pricing plans attract a larger customer base, but financial analysts have determined that annual members are more profitable. However, casual riders are already aware of the Cyclistic program and have chosen Cyclistic to meet their mobility needs. This suggests that a marketing campaign that targets existing customers is likely to be more effective at expanding the business than a campaign that targets only new customers.

Therefore, Cyclistic's marketing analytics team is interested in understanding how casual riders and annual members use Cyclistic bikes differently. By understanding these differences, the marketing analytics team can develop more targeted marketing strategies to convert casual riders into annual members.

## Purpose

This report analyzes Cyclistic's historical bike trip data from 2022 in order to identify how annual members and casual riders use Cyclistic bikes differently. The report aims to extract insights and develop the most appropriate marketing strategies that appeal to casual riders and encourage them to subscribe to annual memberships. This will enable the business to improve productivity and respond to economic changes in a productive and efficient manner. The report outlines the behavioral differences in Cyclistic bike usage between annual members and casual riders. The report further demonstrates that the recommended solutions will help Cyclistic to expand its business growth.

## Stakeholders

Key stakeholders include:

- Marketing analytics team who collect, analyze, and report data to help guide Cyclistic's marketing strategy
- Marketing manager who supports the marketing campaign to promote Cyclistic's bike-share program
- Executive team who approve the recommended marketing program

# Data Sources

This report uses Cyclistic's historical trip data from January 2022 to December 2022 as its primary source. The data sets can be downloaded from the company's website, which can be find in the following details:

- Data Source: [Trip History Data](https://divvy-tripdata.s3.amazonaws.com/index.html)
- Data Website: [System Data Website](https://divvybikes.com/system-data)
- License: [Data License Agreement](https://ride.divvybikes.com/data-license-agreement)

The data sets are collected by the City of Chicago (a government agency) and published by Cyclistic. They contain historical trip data for all of the company's customer (rider) data since 2013, including the following information: ride history, the location of stations for each ride, and other relevant information

## Data Description

The data set is stored in twelve CSV files, one for each month of 2022 (*202201-divvy-tripdata.csv* through *202212-divvy-tripdata.csv*). Each file contains a set of fields (columns) and records (rows). Each record represents a single bike trip, which is uniquely identified by an identifier for the ride.

The data sets contain the following fields:

- `ride_id` : A unique identifier for the ride
- `rideable_type` : The type of bike for the ride (classic bike, electric bike or docked bike)
- `started_at` : The date and time at which the ride started
- `ended_at` : The date and time at which the ride ended
- `start_station_id` : The ID of the station where the ride started
- `start_station_name` : The name of the station where the ride started
- `end_station_id` : The ID of the station where the ride ended
- `end_station_name` : The name of the station where the ride ended
- `start_lat` : The latitude of the station where the ride started
- `start_lng` : The longitude of the station where the ride started
- `end_lat` : The latitude of the station where the ride ended
- `end_lng` : The longitude of the station where the ride ended
- `member_casual` : The type of user who took the ride (member or casual)

## Data Credibility

The data is evaluated for bias and credibility using the ROCCC method:

- **Reliable**: The data is considered reliable because it is open data provided by Cyclistic and the City of Chicago. It is a comprehensive and accurate dataset of Cyclistic's historical bike trips. The data includes information on the start and end location of each trip, the time of day the trip was taken, the type of user (casual or annual member), and the length of the trip. There are some missing values in some fields, but these can be used to explore how different customer types use Cyclistic bikes.
- **Original**: The data is considered to be original, based on a primary source of information from the company.
- **Comprehensive**: It is important to note that Cyclistic is subject to data privacy restrictions that prohibit the use of riders' personally identifiable information (PII). This means that the company cannot connect pass purchases to credit card numbers to determine if casual riders live in the Cyclistic service area or if they have purchased multiple single passes, as well as identify the rider's gender and age. Despite these restrictions, the data is complete and contains all the information needed to understand how members and casual riders use Cyclistic bikes. This includes information such as the number of rides taken, the length of each ride, the start and end stations of each ride, the time of day each ride was taken.
- **Current**: The data is current and updated monthly. The selected datasets are the most recent data available.
- **Cited**: The data is properly cited as it contains the dataset name, author, and published year.

Overall, the Cyclistic bike data is considered a credible source for analysis based on the Reliability, Originality, Comprehensiveness, Currency, and Citation (ROCCC) method. The data can be used to explore how different customer types use Cyclistic bikes. For example, the data can be used to determine which customer segments are most likely to use Cyclistic bikes for commuting, recreation, or transportation. The data can also be used to identify trends in bike usage, such as the time of day when bikes are most likely to be used or the types of bikes that are most popular.

While there are some restrictions on rider's personal information, there is still a great deal of information that can be learned from it. However, the data needs to be processed before analysis can be performed. This includes cleaning the data to remove errors and inconsistencies, and transforming the data into a format that is suitable for analysis. The data processing will be performed in the next section.

# Data Cleaning and Manipulation

This section provides a documentation of data cleaning and manipulation. The ***R programming language*** is used in conjunction with the ***RStudio*** integrated development environment (IDE) to complete data cleaning's tasks, including loading packages, importing and combining the data, cleaning the data, transforming the data and removing outliers. R script is available on the [GitHub repository](https://github.com/thanakorntha/cyclistic-analysis/tree/main/scripts/1-data-cleaning.R).

## Loading the Packages

Prior to cleaning the data, it is important to set up the R environment first. This requires loading the following packages into the environment:

- `tidyverse` for importing, wrangling and visualizing the data
- `skimr` for skimming the data
- `janitor` for exploring and cleaning the data
- `scales` for 

```{r load-packages}
library(tidyverse)
library(skimr)
library(janitor)
library(scales)
```

***Note:*** *Make sure to install required packages using* `install.packages()` *before loading packages through* `library()`.

## Importing and Combining the Data

```{r import-data}
trip_data <- list.files(path = "./data/", 
                        pattern = "*.csv", 
                        full.names = TRUE) %>% 
  lapply(read_csv) %>% 
  bind_rows %>% 
  arrange(started_at)
```

Once packages are completely loaded, it is ready to import the data into the R environment. Each CSV file was imported into the environment. Subsequently, these data frames were combined into a single data frame, named ***trip_data***. Upon initial inspection, the data frame contains `r prettyNum(count(trip_data), big.mark = ",")` rows and `r prettyNum(ncol(trip_data))` columns. The table below provides a preview of the *trip_data* data frame.

```{r preview-data}
trip_data %>% 
  head(1) %>% 
  t() %>% 
  knitr::kable("simple", caption = "A preview of the Cyclistic's historical trip data")
```

## Cleaning the Data

The result of the `skim_without_charts()` function provides a concise summary of the *trip_data* dataset. The dataset contains `r prettyNum(count(trip_data), big.mark = ",")` rows and `r prettyNum(ncol(trip_data))` columns. The figure shows that the unique number of rows of `ride_id` is `r prettyNum(length(unique(trip_data$ride_id)), big.mark = ",")` rows, which is the same as the total number of rows. Therefore, it can be concluded that there are no duplicate values in the dataset.

![A broad overview of dataset summary in the Cyclistic's historical trip data (*trip_data*) from `skim_without_charts()`](./images/pre-skim-data.png){width="90%"}

There are three data types in the dataset, including character, numeric and POSIXct. First, the **character** data type represents text or string values. Second, the **numeric** data type represents decimal values. Last, the **POSIXct** data type represents data and time values. Each data type include the following columns:

- **character:** `ride_id`, `rideable_type`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id` and `member_casual`.
- **numeric:** `start_lat`, `start_lng`, `end_lat` and `end_lng`.
- **POSIXct:** `started_at` and `ended_at`.

The figure also shows that some columns have missing values. The following columns include:

- `start_station_name` (`r prettyNum(sum(is.na(trip_data$start_station_name)), big.mark = ",")` rows)
- `start_station_id` (`r prettyNum(sum(is.na(trip_data$start_station_id)), big.mark = ",")` rows)
- `end_station_name` (`r prettyNum(sum(is.na(trip_data$end_station_name)), big.mark = ",")` rows)
- `end_station_id` (`r prettyNum(sum(is.na(trip_data$end_station_id)), big.mark = ",")` rows)
- `end_lat` (`r prettyNum(sum(is.na(trip_data$end_lat)), big.mark = ",")` rows)
- `end_lng` (`r prettyNum(sum(is.na(trip_data$end_lng)), big.mark = ",")` rows)

There are multiple ways to handle missing data, but in this case, it was decided to remove those columns as they are not required for this analysis. The following R code was used to select only the useful columns and then store the new dataset as ***trip_data_v2***:

 

```{r clean-data, echo=TRUE}
trip_data_v2 <- trip_data %>%
  select(ride_id, started_at, ended_at, rideable_type, member_casual)
```

 

Finally, the *trip_data_v2* dataset has only 5 columns, which are `ride_id`, `started_at` and `ended_at`, `rideable_type`and `member_casual`.

## Transforming the Data

The next step is to add three new columns to the dataset, namely `month`, `day_of_week`, and `ride_length`, in order to facilitate data analysis and visualization. The `month` column will store the month in which the trip was taken, the `day_of_week` column will store the day of the week on which the trip was taken, and the `ride_length` column will store the duration of the trip in minutes. The following R codes can be used to add these three new columns to the dataset:

 

```{r add-new-columns, echo=TRUE}
trip_data_v2$ride_length <- as.double(
  difftime(trip_data_v2$ended_at, 
           trip_data_v2$started_at, 
           units = "mins"))
trip_data_v2$day_of_week <- weekdays(trip_data_v2$started_at)
trip_data_v2$month <- format(trip_data_v2$started_at, "%b")
```

 

## Removing Outliers

Once three new columns have been added to the dataset, it can be used for data analysis and visualization. The `skim_without_charts()` function is used to provides a concise summary of the *trip_data_v2* dataset again. The figure shows that there are minus number in minimum value (min) in the `ride_length` column. 

![A broad overview of dataset summary in the Cyclistic's historical trip data (*trip_data_v2*) from `skim_without_charts()`](./images/post-skim-data.png){width="90%"}

This means that there are outliers in the datset. Outliers can be caused by errors in data entry, measurement, or other factors. They can distort the results of an analysis, so it is important to remove them before proceeding. In this case, all trip data that were less than 60 seconds were filtered out. These trips are likely to be false starts or users attempting to re-dock a bike to ensure its security. Trips that exceeded a period of 24 consecutive hours were also removed. This is because these trips are likely to be the result of the rider not returning the bike. This was accomplished by running the following R code:

 

```{r remove-outliers, echo=TRUE}
error_rows <- trip_data_v2$ride_length < 1 
timeout_rows <- trip_data_v2$ride_length > 1440

trip_data_v2 <- trip_data_v2[!(error_rows | timeout_rows), ]
```

 

This completes the data cleaning and manipulation process, and the data is now ready for analysis.

# Analysis and Key Findings

This section presents an analysis of Cyclistic's historical trip data from January 2022 to December 2022, with the objective of identifying the differences in the use of Cyclistic bikes between annual members and casual riders. The R script used for this analysis is available on the [GitHub repository](https://github.com/thanakorntha/cyclistic-analysis/tree/main/scripts/2-data-analysis.R).

```{r setup-2}
# Convert the 'day_of_week' column to a factor variable with a specified level order
trip_data_v2$day_of_week <- ordered(
  trip_data_v2$day_of_week, 
  levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")
)

# Order the levels of the month from January to December
trip_data_v2$month <- ordered(
  trip_data_v2$month, 
  levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
)

# Set default theme
theme_set(theme_bw())

# Set default plot theme
plot_theme <- theme(
  axis.title.x = element_text(size = 8), 
  axis.title.y = element_text(size = 8), 
  axis.text.x = element_text(size = 6), 
  axis.text.y = element_text(size = 6), 
  plot.title = element_text(size = 9, face = "bold"), 
  plot.subtitle = element_text(size = 8), 
  plot.caption = element_text(size = 6, face = "italic", hjust = 0), 
  panel.grid.major = element_blank(), 
  panel.grid.minor = element_blank()
)

# Set default legend theme
legend_theme <- theme(
  legend.title = element_text(size = 8), 
  legend.text = element_text(size = 7)
)

# Define function to calculate mode
find_mode <- function(x) {
  u <- unique(x)
  tab <- tabulate(match(x, u))
  u[tab == max(tab)]
}
```

## All Users

Irure velit reprehenderit nostrud aliqua do velit. Ipsum exercitation quis commodo cillum. Ex eu elit laborum Lorem. Occaecat sit sint pariatur sit nulla nostrud exercitation amet ipsum pariatur magna dolor commodo mollit esse. Quis est incididunt velit ut mollit excepteur ad esse eiusmod fugiat.

```{r summary-table}
# Create descriptive statistics of the 'ride_length' column (also use summary(trip_data_v2$ride_length))
trip_data_v2 %>% 
  summarize(
    min = min(ride_length), 
    q1 = quantile(ride_length, 0.25), 
    mean = mean(ride_length), 
    median = median(ride_length), 
    q3 = quantile(ride_length, 0.75), 
    max = max(ride_length), 
    sd = sd(ride_length), 
    count = n()
  ) %>% 
  knitr::kable(
    format = "simple", 
    caption = "A statistical summary of the duration of ride in the Cyclistic's historical trip data"
  )
```

Irure velit reprehenderit nostrud aliqua do velit. Ipsum exercitation quis commodo cillum. Ex eu elit laborum Lorem. Occaecat sit sint pariatur sit nulla nostrud exercitation amet ipsum pariatur magna dolor commodo mollit esse. Quis est incididunt velit ut mollit excepteur ad esse eiusmod fugiat.

 

```{r plot-distribution-duration-all}
# Define labels for the plot
label_1 <- labs(
  x = "Duration of ride (in minutes)", 
  y = "Number of rides", 
  title = "The majority of riders spent less time on their bikes than the average", 
  subtitle = "Distribution of ride duration for all users, 2022", 
  caption = "Source: Cyclistic (Divvy) dataset with 5,541,268 ride records"
)

# Define a text annotation for average line
annotation_1 <- annotate(
  geom = "text", 
  label = "AVG = 16.61 min.", 
  x = mean(trip_data_v2$ride_length), 
  y = Inf, 
  vjust = -0.75, 
  hjust = -0.1, 
  angle = "270", 
  size = 2, 
  color = "#c76a27"
)

# Create a histogram of ride length
ggplot(trip_data_v2, aes(x = ride_length)) + 
  geom_histogram(color = "black", fill = "#2C7EB8") +
  # Add a vertical line at the average ride length
  geom_vline(
    aes(xintercept = mean(ride_length)), 
    linetype = "dashed", 
    size = 0.5, 
    color = "#c76a27"
  ) + 
  # Add a text annotation to label the average ride length
  annotation_1 + 
  # Format the x-axis and the y-axis 
  xlim(0, 60) + 
  expand_limits(y = c(0, 800000)) + 
  scale_y_continuous(labels = unit_format(unit = "k", scale = 1e-3)) + 
  # Add a title, legend and color theme
  label_1 + 
  plot_theme + theme(legend.position = "none") + 
  scale_fill_brewer(palette = "YlGnBu")
```

 

## User Type

```{r define-user-variables}
# Group the data by the 'member_casual' column, calculating the mean, median, mode and count for each group
stats_user <- trip_data_v2 %>% 
  group_by(member_casual) %>% 
  summarize(
    mean_ride_length = mean(ride_length), 
    median_ride_length = median(ride_length), 
    mode_ride_length = find_mode(ride_length), 
    ride_count = n()
  )
```

Irure velit reprehenderit nostrud aliqua do velit. Ipsum exercitation quis commodo cillum. Ex eu elit laborum Lorem. Occaecat sit sint pariatur sit nulla nostrud exercitation amet ipsum pariatur magna dolor commodo mollit esse. Quis est incididunt velit ut mollit excepteur ad esse eiusmod fugiat.

 

```{r plot-distribution-duration-user}
# Define labels for the plot
label_2 <- labs(
  x = "Duration of ride (in minutes)", 
  y = "Number of rides", 
  title = "Casual riders spent more time riding bikes", 
  subtitle = "Distribution of ride duration for casual riders and members, 2022", 
  caption = "Source: Cyclistic (Divvy) dataset with 5,541,268 ride records"
)

# Define text annotations for average line
annotation_2 <- annotate(
  geom = "text", 
  label = c("AVG (casual) = 22.30 min.", "AVG (member) = 12.66 min."), 
  x = stats_user$mean_ride_length, 
  y = Inf, 
  vjust = -0.75, 
  hjust = -0.1, 
  angle = "270", 
  size = 2, 
  color = "#c76a27"
)

# Create a histogram of ride length
ggplot(trip_data_v2, aes(x = ride_length, fill = member_casual)) + 
  geom_histogram(color = "black") +
  # Add a vertical line at the average ride length
  geom_vline(
    aes(xintercept = mean_ride_length), 
    stats_user, 
    linetype = "dashed", 
    size = 0.5, 
    color = "#c76a27"
  ) + 
  # Add text annotations to label the average ride length
  annotation_2 + 
  # Format the x-axis and the y-axis 
  xlim(0, 60) + 
  expand_limits(y = c(0, 800000)) + 
  scale_y_continuous(labels = unit_format(unit = "k", scale = 1e-3)) + 
  # Add a title, legend and color theme
  label_2 + labs(fill = "User Type") + 
  plot_theme + legend_theme + theme(legend.position = c(0.9, 0.85)) + 
  scale_fill_brewer(palette = "YlGnBu")
```

 

Irure velit reprehenderit nostrud aliqua do velit. Ipsum exercitation quis commodo cillum. Ex eu elit laborum Lorem. Occaecat sit sint pariatur sit nulla nostrud exercitation amet ipsum pariatur magna dolor commodo mollit esse. Quis est incididunt velit ut mollit excepteur ad esse eiusmod fugiat.

 

```{r plot-bar-duration-user}
# Define labels for the plot
label_3 <- labs(
  x = "User type", 
  y = "Duration of ride (in minutes)", 
  title = "Casual riders were more likely to take longer rides than annual members", 
  subtitle = "Average ride duration for casual riders and annual members, 2022", 
  caption = "Source: Cyclistic (Divvy) dataset with 5,541,268 ride records"
)

# Define text annotation for line difference 
annotation_31 <- annotate(
  "pointrange", 
  x = 2, 
  y = 17.48, 
  ymin = 12.66 + 0.5, 
  ymax = 22.30 - 0.5, 
  colour = "#c76a27", 
  size = 1, 
  linewidth = 1.5
)

# Define text annotation for value difference
annotation_32 <- annotate(
  "text", 
  label = "+ 9.64", 
  x = 2, 
  y = 17.48, 
  hjust = -0.4, 
  color = "#c76a27"
)

# Plot a bar chart of average ride length grouped by user type
ggplot(stats_user, aes(x = member_casual, y = mean_ride_length, fill = member_casual)) + 
  geom_bar(stat = "identity", color = "black") +
  # Add text for average plot
  geom_text(
    aes(label = round(mean_ride_length, 2)), 
    position = position_dodge(width = 0.9), 
    vjust = 2
  ) + 
  # Add text annotations to label value difference
  annotation_31 + annotation_32 +
  # Format the x-axis and the y-axis 
  expand_limits(y = c(0, 30)) + 
  # Add a title, legend and color theme
  label_3 + 
  plot_theme + theme(legend.position = "none") + 
  scale_fill_brewer(palette = "YlGnBu")
```

 

```{r plot-bar-count-user}
# Define labels for the plot
label_4 <- labs(
  x = "User type", 
  y = "Number of rides", 
  title = "Annual members were more likely to be regular riders of Cyclistic bikes than casual riders", 
  subtitle = "Total number of rides for casual riders and annual members, 2022", 
  caption = "Source: Cyclistic (Divvy) dataset with 5,541,268 ride records"
)

# Define text annotation for line difference 
annotation_41 <- annotate(
  "pointrange", 
  x = 1, 
  y = 2770634, 
  ymin = 2269498 + 50000, 
  ymax = 3271770 - 50000, 
  colour = "#c76a27", 
  size = 1, 
  linewidth = 1.5
)

# Define text annotation for value difference
annotation_42 <- annotate(
  "text", 
  label = "+ 1,002,272", 
  x = 1, 
  y = 2770634, 
  hjust = -0.2, 
  color = "#c76a27"
)

# Plot a bar chart of ride count grouped by user type
ggplot(stats_user, aes(x = member_casual, y = ride_count, fill = member_casual)) + 
  geom_bar(stat = "identity", color = "black") + 
  # Add text for average plot
  geom_text(
    aes(label = prettyNum(ride_count, big.mark = ",")), 
    position = position_dodge(width = 0.9), 
    vjust = 2
  ) + 
  # Add text annotations to label value difference
  annotation_41 + annotation_42 +
  # Format the x-axis and the y-axis 
  expand_limits(y = c(0, 4000000)) + 
  scale_y_continuous(labels = unit_format(unit = "M", scale = 1e-6)) + 
  # Add a title, legend and color theme
  label_4 + 
  plot_theme + theme(legend.position = "none") + 
  scale_fill_brewer(palette = "YlGnBu")
```

 

\newpage

## Day of Week

```{r define-user-day-variables}
# Group the data by 'member_casual' and 'day_of_week' columns, calculating the mean, median, mode and count for each group
stats_user_month <- trip_data_v2 %>% 
  group_by(member_casual, day_of_week) %>% 
  summarize(
    mean_ride_length = mean(ride_length), 
    median_ride_length = median(ride_length), 
    mode_ride_length = find_mode(ride_length), 
    ride_count = n(), 
    .groups = "drop"
  )
```

```{r ride-length-user-day}
# Plot a bar chart of average ride length grouped by user type and day of week
ggplot(ride_length_user_day, aes(x = day_of_week, y = mean_ride_length, fill = member_casual)) + 
  geom_bar(stat = "identity", position = "dodge", color = "black") + 
  expand_limits(y = c(0, 30)) + 
  geom_text(
    aes(label = round(mean_ride_length, 2)), 
    position = position_dodge(width = 0.9), 
    vjust = 2, 
    size = 2.5
  ) + 
  labs(
    x = "Day of Week", 
    y = "Average Ride Length", 
    title = "Average Ride Length in Minute by Day of Week", 
    subtitle = "Data from January 2022 to December 2022", 
    caption = "Source: Divvy dataset"
  ) + 
  theme(
    axis.title.x = element_text(size = 8), 
    axis.title.y = element_text(size = 8), 
    axis.text.x = element_text(size = 6), 
    axis.text.y = element_text(size = 6), 
    plot.title = element_text(size = 10, face = "bold"), 
    plot.subtitle = element_text(size = 8), 
    plot.caption = element_text(size = 6, face = "italic", hjust = 0), 
    legend.position = "none"
  ) + 
  scale_fill_brewer(palette = "Pastel1")
```

```{r ride-count-user-day}
# Group the data by 'member_casual' and 'day_of_week' columns, counting the number of rides for each group
ride_count_user_day <- trip_data_v2 %>% 
  group_by(member_casual, day_of_week) %>% 
  summarize(ride_count = n())

# Plot a bar chart of ride count grouped by user type and day of week
ggplot(ride_count_user_day, aes(x = day_of_week, y = ride_count, fill = member_casual)) + 
  geom_bar(stat = "identity", position = "dodge", color = "black") + 
  expand_limits(y = c(0, 450000)) + 
  scale_y_continuous(labels = unit_format(unit = "k", scale = 1e-3)) + 
  geom_text(
    aes(label = prettyNum(ride_count, big.mark = ",")), 
    position = position_dodge(width = 0.9), 
    vjust = 2, 
    size = 2
  ) + 
  labs(
    x = "Day of Week", 
    y = "Number of Rides", 
    title = "Number of Rides by Day of Week", 
    subtitle = "Data from January 2022 to December 2022", 
    caption = "Source: Divvy dataset"
  ) + 
  theme(
    axis.title.x = element_text(size = 8), 
    axis.title.y = element_text(size = 8), 
    axis.text.x = element_text(size = 6), 
    axis.text.y = element_text(size = 6), 
    plot.title = element_text(size = 10, face = "bold"), 
    plot.subtitle = element_text(size = 8), 
    plot.caption = element_text(size = 6, face = "italic", hjust = 0), 
    legend.position = "none"
  ) + 
  scale_fill_brewer(palette = "Pastel1")
```

\newpage

## Month

```{r ride-length-user-month}
# Group the data by 'member_casual' and 'month' columns, calculating the mean and median of 'ride_length' for each group
ride_length_user_month <- trip_data_v2 %>% 
  group_by(member_casual, month) %>% 
  summarize(mean_ride_length = mean(ride_length), 
            median_ride_length = median(ride_length))

# Plot a bar chart of average ride length grouped by user type and month
ggplot(ride_length_user_month, aes(x = month, y = mean_ride_length, group = member_casual)) + 
  geom_line(aes(color = member_casual), size = 1) + 
  geom_point(aes(color = member_casual), size = 2) + 
  expand_limits(y = c(0, 30)) + 
  geom_text(
    aes(label = round(mean_ride_length, 2)), 
    nudge_y = 1.5, 
    check_overlap = TRUE,
    size = 2.5
  ) + 
  labs(
    x = "Month", 
    y = "Average Ride Length", 
    title = "Average Ride Length in Minute by Month", 
    subtitle = "Data from January 2022 to December 2022", 
    caption = "Source: Divvy dataset"
  ) + 
  theme(
    axis.title.x = element_text(size = 8), 
    axis.title.y = element_text(size = 8), 
    axis.text.x = element_text(size = 6), 
    axis.text.y = element_text(size = 6), 
    plot.title = element_text(size = 10, face = "bold"), 
    plot.subtitle = element_text(size = 8), 
    plot.caption = element_text(size = 6, face = "italic", hjust = 0), 
    legend.position = "none"
  ) + 
  scale_fill_brewer(palette = "Pastel1")
```

```{r ride-count-user-month}
# Group the data by 'member_casual' and 'month' columns, counting the number of rides for each group
ride_count_user_month <- trip_data_v2 %>% 
  group_by(member_casual, month) %>% 
  summarize(ride_count = n())

# Plot a line chart of ride count grouped by user type and day of week
ggplot(ride_count_user_month, aes(x = month, y = ride_count, group = member_casual)) + 
  geom_line(aes(color = member_casual), size = 1) + 
  geom_point(aes(color = member_casual), size = 2) + 
  expand_limits(y = c(0, 450000)) + 
  scale_y_continuous(labels = unit_format(unit = "k", scale = 1e-3)) + 
  geom_text(
    aes(label = prettyNum(ride_count, big.mark = ",")), 
    nudge_y = 15000, 
    check_overlap = TRUE,
    size = 2
  ) + 
  labs(
    x = "Month", 
    y = "Number of Rides", 
    title = "Number of Rides by Month", 
    subtitle = "Data from January 2022 to December 2022", 
    caption = "Source: Divvy dataset"
  ) + 
  theme(
    axis.title.x = element_text(size = 8), 
    axis.title.y = element_text(size = 8), 
    axis.text.x = element_text(size = 6), 
    axis.text.y = element_text(size = 6), 
    plot.title = element_text(size = 10, face = "bold"), 
    plot.subtitle = element_text(size = 8), 
    plot.caption = element_text(size = 6, face = "italic", hjust = 0), 
    legend.position = "none"
  ) + 
  scale_fill_brewer(palette = "Pastel1")
```

<!--

## Key Findings

Based on data analysis, : 

- 
- 
- 
- 
- 

-->

# Conclusion and Recommendations

> To be written

<!--

## Conclusion

Based on the data collected, it can be concluded that

## Recommendations

The report makes the following recommendations:

1. 
2. 
3. 

-->
